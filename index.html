<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Láser Palafrugell</title>
  <style>
    *{margin:0;padding:0;box-sizing:border-box;font-family:Arial,sans-serif;}
    body{background:#000;color:#fff;overflow-x:hidden;}

    .topbar{background:#00ff41;padding:15px 20px;display:flex;justify-content:space-between;align-items:center;position:fixed;width:100%;top:0;z-index:1000;}
    .logo{font-weight:bold;color:#000;font-size:18px;}
    .icons img{width:28px;margin-left:15px;}

    .secret-admin{
      position:fixed;top:70px;right:10px;width:46px;height:46px;background:#ffcc00;
      border-radius:50%;display:flex;align-items:center;justify-content:center;
      font-size:26px;color:#000;box-shadow:0 0 20px rgba(255,204,0,0.9);
      z-index:9999;opacity:0.8;transition:all 0.4s;cursor:pointer;
    }
    .secret-admin:hover{opacity:1;transform:scale(1.3) rotate(30deg);}

    .lang-btn{background:#ffcc00;color:#000;border:none;padding:8px 25px;border-radius:30px;font-weight:bold;font-size:16px;margin:70px auto 15px;display:block;cursor:pointer;}

    .page{display:none;padding-top:80px;}
    .page.active{display:block;}

    .home{text-align:center;padding:40px 20px 100px;}
    .home h1{font-size:48px;color:#ffcc00;margin-bottom:20px;line-height:1.2;}
    .home p{font-size:22px;margin-bottom:60px;opacity:0.9;}
    .buttons{display:flex;justify-content:center;gap:40px;flex-wrap:wrap;}
    .btn-big{background:#1a1a1a;border:3px solid #ffcc00;border-radius:20px;width:160px;height:160px;display:flex;flex-direction:column;justify-content:center;align-items:center;color:#ffcc00;font-size:24px;font-weight:bold;box-shadow:0 0 20px rgba(255,204,0,0.4);transition:0.3s;cursor:pointer;}
    .btn-big:hover{transform:scale(1.1);}
    .btn-big img{width:70px;margin-bottom:15px;}

    .section-title{background:#00ff41;color:#000;padding:15px;font-size:19px;font-weight:bold;text-align:center;position:fixed;width:100%;top:0;z-index:999;}
    .back{position:absolute;left:15px;top:10px;font-size:35px;cursor:pointer;}

    .gallery{display:grid;grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:15px;padding:20px;}
    .gallery img{width:100%;border-radius:12px;border:3px solid #ffcc00;box-shadow:0 0 15px rgba(255,204,0,0.5);transition:0.3s;cursor:zoom-in;}
    .gallery img:hover{transform:scale(1.08);}

    .video-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:20px;padding:20px;}
    .video-wrapper{border:3px solid #ffcc00;border-radius:15px;overflow:hidden;box-shadow:0 0 20px rgba(255,204,0,0.4);cursor:pointer;}
    video{width:100%;display:block;}

    .lightbox{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.98);z-index:9999;align-items:center;justify-content:center;padding:20px;}
    .lightbox img,.lightbox video{max-width:95%;max-height:95%;border-radius:15px;border:4px solid #ffcc00;box-shadow:0 0 30px rgba(255,204,0,0.8);}
    .close-light{position:absolute;top:20px;right:20px;font-size:40px;color:#ffcc00;cursor:pointer;z-index:99999;}

    #admin{display:none;background:rgba(0,0,0,0.98);position:fixed;top:0;left:0;width:100%;height:100%;z-index:2000;padding:20px;overflow-y:auto;}
    #admin h2{color:#ffcc00;text-align:center;margin:20px 0;font-size:26px;}
    #admin label{display:block;background:#333;padding:20px;border-radius:12px;margin:15px 0;text-align:center;color:#ffcc00;font-size:18px;cursor:pointer;border:2px dashed #ffcc00;}
    #admin input[type=file]{display:none;}
    .preview img,.preview video{max-width:100%;margin:15px 0;border:3px solid #ffcc00;border-radius:12px;}
    #admin button{margin:12px 0;width:100%;padding:16px;border-radius:12px;font-size:18px;border:none;font-weight:bold;cursor:pointer;}
    .save-btn{background:#25d366;color:#fff;}
    .close-btn{background:#e91e63;color:#fff;}

    .wa{position:fixed;bottom:25px;right:20px;width:60px;height:60px;background:#25d366;color:#fff;border-radius:50%;font-size:35px;display:flex;align-items:center;justify-content:center;box-shadow:0 4px 15px rgba(0,0,0,0.6);z-index:9999;text-decoration:none;}
    .wa:hover{transform:scale(1.2);}
  </style>
</head>
<body>

  <div class="topbar">
    <div class="logo">Laser palafrugell | Chat</div>
    <div class="icons">
      <img src="https://img.icons8.com/color/48/share.png">
      <img src="https://img.icons8.com/fluency/48/bell.png">
    </div>
  </div>

  <div class="secret-admin" onclick="document.getElementById('admin').style.display='block'">Key</div>

  <button class="lang-btn">Español</button>

  <div id="home" class="page home active">
    <h1>¡Bienvenidos al mundo del láser y dulces!</h1>
    <p>Nuevos diseños cada día para eventos y celebraciones</p>
    <div class="buttons">
      <div class="btn-big" onclick="show('fotos')"><img src="https://img.icons8.com/color/96/image-gallery.png"><span>Fotos</span></div>
      <div class="btn-big" onclick="show('videos')"><img src="https://img.icons8.com/color/96/video.png"><span>Videos</span></div>
    </div>
  </div>

  <div id="fotos" class="page">
    <div class="section-title"><span class="back" onclick="show('home')">Back</span> Nuestras Fotos</div>
    <div class="gallery" id="photoGallery"></div>
  </div>

  <div id="videos" class="page">
    <div class="section-title"><span class="back" onclick="show('home')">Back</span> Nuestros Videos</div>
    <div class="video-grid" id="videoGallery"></div>
  </div>

  <!-- نافذة التكبير -->
  <div class="lightbox" id="lightbox" onclick="this.style.display='none'">
    <span class="close-light">×</span>
    <img id="lightimg" onclick="event.stopPropagation()">
    <video id="lightvid" controls onclick="event.stopPropagation()"></video>
  </div>

  <!-- لوحة الأدمن -->
  <div id="admin">
    <h2>Panel Admin</h2>
    <input type="password" id="adminPass" placeholder="كلمة السر">
    <button onclick="checkPass()" style="background:#ffcc00;color:#000;">دخول</button>

    <div id="adminPanel" style="display:none;">
      <label for="photoInput">اضغطي هنا لرفع صور جديدة</label>
      <input type="file" id="photoInput" accept="image/*" multiple>

      <label for="videoInput">اضغطي هنا لرفع فيديو جديد</label>
      <input type="file" id="videoInput" accept="video/*">

      <div class="preview" id="preview"></div>

      <button class="save-btn" onclick="saveAll()">حفظ وإغلاق</button>
      <button class="close-btn" onclick="document.getElementById('admin').style.display='none'">إغلاق بدون حفظ</button>
    </div>
  </div>

  <a href="https://wa.me/212601234567" class="wa" target="_blank">Chat</a>

  <script src="https://cdn.jsdelivr.net/npm/idb@7/build/umd.js"></script>
  <script>
    const ADMIN_PASS = "laser2025"; // ← غيريها

    const dbPromise = idb.openDB('laserDB', 1, {
      upgrade(db) {
        db.createObjectStore('photos');
        db.createObjectStore('videos');
      }
    });

    async function loadAll() {
      const db = await dbPromise;
      const photoKeys = await db.getAllKeys('photos');
      const videoKeys = await db.getAllKeys('videos');

      const photoGallery = document.getElementById('photoGallery');
      const videoGallery = document.getElementById('videoGallery');

      photoGallery.innerHTML = '';
      videoGallery.innerHTML = '';

      for (const key of photoKeys) {
        const blob = await db.get('photos', key);
        const url = URL.createObjectURL(blob);
        photoGallery.innerHTML += `<img src="${url}" onclick="openLight('${url}')">`;
      }
      for (const key of videoKeys) {
        const blob = await db.get('videos', key);
        const url = URL.createObjectURL(blob);
        videoGallery.innerHTML += `<div class="video-wrapper" onclick="openLight('${url}',true)"><video controls><source src="${url}"></video></div>`;
      }
    }

    function show(p) {
      document.querySelectorAll('.page').forEach(x => x.classList.remove('active'));
      document.getElementById(p).classList.add('active');
    }

    function openLight(src, isVideo=false) {
      document.getElementById('lightbox').style.display = 'flex';
      if(isVideo){
        document.getElementById('lightvid').src = src;
        document.getElementById('lightvid').style.display = 'block';
        document.getElementById('lightimg').style.display = 'none';
      } else {
        document.getElementById('lightimg').src = src;
        document.getElementById('lightimg').style.display = 'block';
        document.getElementById('lightvid').style.display = 'none';
      }
    }

    function checkPass() {
      if (document.getElementById('adminPass').value === ADMIN_PASS) {
        document.getElementById('adminPanel').style.display = 'block';
        document.getElementById('adminPass').style.display = 'none';
        document.querySelector('#admin > button').style.display = 'none';
      } else alert("كلمة السر غلط!");
    }

    document.getElementById('photoInput').addEventListener('change', async e => {
      const db = await dbPromise;
      for (const file of e.target.files) {
        await db.put('photos', file, Date.now() + Math.random());
        document.getElementById('preview').innerHTML += `<img src="${URL.createObjectURL(file)}">`;
      }
      loadAll();
    });

    document.getElementById('videoInput').addEventListener('change', async e => {
      const db = await dbPromise;
      for (const file of e.target.files) {
        await db.put('videos', file, Date.now() + Math.random());
        document.getElementById('preview').innerHTML += `<video controls><source src="${URL.createObjectURL(file)}"></video>`;
      }
      loadAll();
    });

    function saveAll() {
      alert("تم الحفظ بنجاح! الصور والفيديوهات ظهرت عند الكل");
      document.getElementById('admin').style.display='none';
    }

    // تحميل كلشي لما تفتحي الصفحة
    loadAll();
  </script>
</body>
</html>
